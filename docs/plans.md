# Анализ приложения Mentem v0.1.0

## Что такое Mentem

**Mentem** — десктопное приложение для управления личными знаниями, построенное на Tauri + Next.js. Объединяет в себе:

- **Систему заметок** (notes, quotes, articles, images, products)
- **Флэш-карточки** с интервальным повторением (swipe-механика)
- **PDF-ридер** с аннотациями и извлечением цитат
- **AI-ассистент** для исследований и автоматической таксономии
- **Веб-клиппер** через deep-link протокол `mentem://`

Данные хранятся локально в markdown-файлах с YAML front matter. Приложение работает полностью офлайн (кроме AI-функций).

---

## Итоговая цель приложения

Mentem стремится стать **единой средой для обучения и исследований**, где пользователь:

1. **Собирает** знания из разных источников (PDF, веб, собственные заметки)
2. **Организует** их с помощью тегов и AI-автокатегоризации
3. **Запоминает** через флэш-карточки с интервальным повторением
4. **Исследует** темы с помощью AI-ассистента
5. **Связывает** всё вместе — цитата из PDF становится карточкой, карточка получает теги, теги объединяют знания из разных источников

Философия: **local-first, AI-augmented, knowledge-centric**.

---

## Текущее состояние (v0.1.0)

### Что работает хорошо

| Область | Описание |
|---------|----------|
| **Архитектура** | Чистый FSD с ESLint-правилами, Zustand-сторы, markdown-персистенция — хорошая основа |
| **PDF-ридер** | Полнофункциональный: навигация, зум, поиск, контекстное меню, извлечение цитат с позицией |
| **Система типов памяти** | 6 типов (note, card, quote, article, image, product) — гибкая модель |
| **Дизайн-система** | Tailwind v4 + Base UI + CVA, тёмная/светлая тема, IBM Plex шрифты, 40+ компонентов |
| **Флэш-карточки** | Swipe-механика с Framer Motion, клавиатурные шорткаты, стековый вид |
| **Deep linking** | `mentem://clip/article` для веб-клиппинга |

### Что требует доработки

| Область | Проблема |
|---------|----------|
| **Spaced Repetition** | Нет алгоритма интервального повторения (SM-2, FSRS). Swipe left/right ни на что не влияет — нет отслеживания прогресса, нет расписания повторений |
| **Исследования** | Страница `/research` минимальна — только форма ввода и отображение вопроса. Нет отображения результатов, источников, финального отчёта |
| **Цитаты** | In-memory хранение (useQuoteStore не персистирует). Цитаты теряются при перезапуске |
| **Поиск** | Поиск только по тегам. Нет полнотекстового поиска по содержимому заметок/карточек |
| **AI-модель** | Используется один бесплатный Arcee Trinity. Настройка "thinking/flesh" в UI ни на что не влияет (обе переменные указывают на одну модель) |
| **Синхронизация** | Нет синхронизации между устройствами. Данные привязаны к локальной файловой системе |
| **Онбординг** | Нет пустых состояний, подсказок, туториала. Новый пользователь видит пустые страницы |

---

## Точки развития (новые фичи)

### 1. Алгоритм интервального повторения (Приоритет: КРИТИЧЕСКИЙ)
**Проблема:** Ядро продукта — обучение через карточки — не имеет основного механизма.
**Что нужно:**
- Реализовать FSRS или SM-2 алгоритм
- Хранить историю ответов (ease, interval, next_review_date) в метаданных карточки
- Ежедневная очередь "к повторению" с приоритизацией
- Статистика обучения (выученные, новые, просроченные)
- Визуальный прогресс и тепловая карта активности

### 2. Граф знаний и связи между элементами (Приоритет: ВЫСОКИЙ)
**Проблема:** Единственная связь — теги. Нет прямых связей между заметками, карточками, цитатами.
**Что нужно:**
- Двунаправленные ссылки между любыми memory-элементами
- Визуальный граф связей (d3/force-graph)
- Автоматическое обнаружение связей через AI (семантическая близость)
- Backlinks — "что ссылается на этот элемент"

### 3. Полнофункциональный Research Pipeline (Приоритет: ВЫСОКИЙ)
**Проблема:** UI для исследований минимален, TaskStore имеет богатую модель, но она не используется.
**Что нужно:**
- Отображение этапов исследования (tasks, sources, learning)
- Визуализация найденных источников
- Финальный отчёт с возможностью сохранить как заметку
- Превращение результатов исследования в карточки одним кликом

### 4. Полнотекстовый поиск (Приоритет: ВЫСОКИЙ)
**Проблема:** Поиск только по тегам — неэффективен при большом количестве записей.
**Что нужно:**
- Поисковый индекс по всему контенту (FlexSearch / MiniSearch на клиенте)
- Глобальный поиск (Cmd+K) с мгновенными результатами
- Фильтрация по типу, дате, тегам одновременно

### 5. Импорт и экспорт (Приоритет: СРЕДНИЙ)
**Проблема:** Нет способа импортировать существующие данные или экспортировать в другие форматы.
**Что нужно:**
- Импорт из Anki (`.apkg`), Obsidian (markdown vault), CSV
- Экспорт в Anki, PDF, markdown archive
- Bulk-операции (массовое тегирование, удаление)

### 6. Расширенные AI-функции (Приоритет: СРЕДНИЙ)
**Что нужно:**
- Выбор провайдера/модели (OpenAI, Anthropic, локальные модели)
- AI-генерация карточек из заметки или PDF-фрагмента
- AI-подсказки при обучении ("не помнишь? вот контекст...")
- Суммаризация длинных PDF

### 7. Совместная работа и синхронизация (Приоритет: НИЗКИЙ, долгосрочный)
**Что нужно:**
- Синхронизация через Git / облачное хранилище
- Общие колоды карточек
- Экспорт/шаринг отдельных наборов

---

## Точки улучшения текущих фич

### Флэш-карточки (`/learn`)
- **Нет обратной связи после сессии** — добавить экран результатов (правильных/неправильных, время)
- **Нет выбора колоды** — учить можно только все карточки или по URL-параметру
- **Нет поддержки форматирования** — front/back хранятся как plain text, нужен markdown-рендер
- **Нет мультимедиа** — изображения, аудио, LaTeX в карточках

### PDF-ридер (`/reading`)
- **Нет сохранения позиции чтения** — при переоткрытии PDF начинается с первой страницы
- **Хайлайты не персистируются** — выделения теряются при закрытии
- **Нет оглавления (TOC)** — нужна навигация по структуре PDF
- **Нет аннотаций** — только извлечение цитат, нет рукописных/текстовых аннотаций на полях

### Домашняя страница (`/`)
- **Нет пустого состояния** — новый пользователь видит пустую страницу без объяснений
- **Нет сортировки** — только фильтрация по тегам, нет сортировки по дате/типу/имени
- **Нет группировки** — все типы перемешаны в одной masonry-сетке
- **Нет пагинации/виртуализации** — при большом количестве записей будет просадка производительности

### Теги
- **Нет страницы управления тегами** — теги создаются, но нет централизованного UI для их просмотра, переименования, слияния
- **Нет иерархии тегов** — плоская структура, нет parent-child связей
- **Нет цветового различия** — 6 цветов, но нет автоматического назначения или смысловой привязки цвета к категории

### Настройки
- **AI-модель "Auto/Thinking/Flesh"** — UI существует, но обе модели указывают на один и тот же ID. Нужно реализовать реальное переключение
- **Нет управления API-ключами из UI** — ключ задаётся через env-переменную
- **Нет бэкапа/восстановления** — одна кнопка "сбросить настройки", но нет экспорта конфигурации

### Веб-клиппер
- **Нет браузерного расширения** — deep-link `mentem://` подразумевает расширение, но его нет в репозитории
- **Ограниченные типы клиппинга** — только articles, нет сохранения выделенного текста, изображений

---

## Рекомендуемый порядок приоритетов

| # | Задача | Влияние | Сложность |
|---|--------|---------|-----------|
| 1 | Алгоритм SRS (FSRS) | Критическое — без этого нет продукта | Средняя |
| 2 | Экран результатов сессии обучения | Высокое — замыкает цикл обучения | Низкая |
| 3 | Полнотекстовый поиск (Cmd+K) | Высокое — UX при масштабировании | Средняя |
| 4 | Пустые состояния и онбординг | Среднее — первое впечатление | Низкая |
| 5 | Страница управления тегами | Среднее — организация контента | Низкая |
| 6 | Research pipeline UI | Среднее — раскрывает существующий backend | Средняя |
| 7 | Персистенция позиции чтения и хайлайтов | Среднее — UX ридера | Низкая |
| 8 | Markdown-рендер в карточках | Среднее — качество контента | Низкая |
| 9 | Граф знаний | Высокое — дифференциация продукта | Высокая |
| 10 | Импорт/экспорт | Среднее — привлечение пользователей | Средняя |

---

## Резюме

Mentem v0.1.0 — это **solid MVP** с хорошей архитектурой и широким охватом функций. Главный пробел — **отсутствие ядра SRS-алгоритма**, который превращает swipe-механику из визуального эффекта в рабочий инструмент обучения. Вторая ключевая зона — **завершение начатых фич** (research pipeline, реальное переключение AI-моделей, персистенция цитат). Третья — **UX-polish** (пустые состояния, поиск, управление тегами), который критически важен для перехода от прототипа к используемому продукту.
